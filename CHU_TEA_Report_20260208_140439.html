
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>CHU TEA 财务周报</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background-color: #f5f7fa; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { color: #333; text-align: center; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        .timestamp { text-align: center; color: #888; margin-bottom: 30px; font-size: 0.9em; }
        .summary-cards { display: flex; justify-content: space-around; margin-bottom: 30px; }
        .card { background: #fafafa; padding: 20px; border-radius: 8px; text-align: center; width: 30%; border: 1px solid #eee; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .card h3 { margin: 0 0 10px 0; color: #666; font-size: 16px; }
        .card .value { font-size: 24px; font-weight: bold; color: #2c3e50; }
        .chart-container { height: 400px; margin-bottom: 30px; border: 1px solid #f0f0f0; padding: 10px; border-radius: 5px; }
        .footer { text-align: center; color: #999; font-size: 12px; margin-top: 40px; border-top: 1px solid #eee; padding-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>CHU TEA 门店财务周报</h1>
        <div class="timestamp">生成时间: 2026-02-08 14:04:39 | 数据来源: Google Sheets (Excel Mode)</div>

        <div class="summary-cards">
            <div class="card">
                <h3>总销售额 (Total Sales)</h3>
                <div class="value">₽ 1,667,250</div>
            </div>
            <div class="card">
                <h3>总成本 (Total Cost)</h3>
                <div class="value">₽ 450,158</div>
            </div>
            <div class="card">
                <h3>毛利润 (Gross Profit)</h3>
                <div class="value" style="color: green">₽ 321,861</div>
            </div>
        </div>

        <div id="trendChart" class="chart-container"></div>
        <div id="structureChart" class="chart-container"></div>

        <div class="footer">
            Generated by CHU TEA Financial Bot | 自动同步至 iCloud
        </div>
    </div>

    <script>
        var trendChart = echarts.init(document.getElementById('trendChart'));
        var trendOption = {
            title: { text: '财务趋势分析 (Financial Trend)', left: 'center' },
            tooltip: { trigger: 'axis' },
            legend: { top: 'bottom' },
            xAxis: { type: 'category', data: ['月25', '月26', '月27', '月28', '月29', '月30', '月31', '月32', '月33', '月34', '月35', '月36'] },
            yAxis: { type: 'value' },
            series: [
                { name: '销售额', type: 'line', data: [1579500.0, 1719900.0, 1983150.0, 2369250.0, 3071250.0, 3510000.0, 3246750.0, 3159000.0, 2983500.0, 2457000.0, 1755000.0, 1667250.0], smooth: true, itemStyle: { color: '#5470c6' } },
                { name: '成本', type: 'line', data: [426465.0, 464373.0, 535450.5, 639697.5, 829237.5, 947700.0, 876622.5, 852930.0, 805545.0, 663390.0, 473850.0, 450157.5], smooth: true, itemStyle: { color: '#ee6666' } },
                { name: '利润', type: 'bar', data: [266753.777777778, 354924.977777778, 520245.977777778, 762716.777777778, 1203572.77777778, 1479107.77777778, 1313786.77777778, 1258679.77777778, 1148465.77777778, 817823.777777778, 376967.777777778, 321860.777777778], itemStyle: { color: '#91cc75' } }
            ]
        };
        trendChart.setOption(trendOption);

        var structureChart = echarts.init(document.getElementById('structureChart'));
        var structureOption = {
            title: { text: '成本结构 (Cost Structure)', left: 'center' },
            tooltip: { trigger: 'item' },
            series: [{
                type: 'pie',
                radius: ['40%', '70%'],
                data: [{'value': 450157.5, 'name': '原材料 (Materials)'}, {'value': 450450.0, 'name': '人工 (Labor)'}, {'value': 150000.0, 'name': '房租 (Rent)'}]
            }]
        };
        structureChart.setOption(structureOption);
    </script>
</body>
</html>